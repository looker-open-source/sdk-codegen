#!/bin/bash

source "bin/args_parser.sh"
args=()

if [[ "${ARG_FIX}" == "false" ]]; then
  args+=("--check")
fi

if [[ "${ARG_FIX}" == "true" ]] && [[ "${ARG_QUICK}" == "false" ]]; then
  args+=("--write")
fi

cd "$(dirname "${0}")/.." || exit 1

if [[ "${ARG_QUICK}" == "true" ]]; then
  echo "Quick processing changed files supported by prettier"
  # This flag is only supported by pretty-quick
  if [[ "${ARG_STAGED}" == "true" ]]; then
    args+=("--staged")
  fi

  npx pretty-quick "${args[@]}"
else
  echo "ðŸ‘€ Running on your local dev machine? Consider using -q|--quick to check only changed files."
  npx --workspaces prettier . "${args[@]}"
fi
